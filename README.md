# Small-Tools
Python 网络安全工具，涵盖漏洞扫描、密码破解、渗透测试、数据包嗅探、取证分析等领域。每个工具都添加了 丰富的描述、实现思路，以及核心 Python 库，逐步完善所有代码，请关注官网。


## **一、漏洞扫描工具 🕵️‍♂️🔍**

### **1. 简易端口扫描器 🚪🔑**

**作用**：扫描目标主机的开放端口，识别潜在的服务漏洞。

**关键库**：`socket`, `concurrent.futures`

**实现思路**：

- 使用 `socket` 模块尝试连接目标主机的端口。
- 利用线程池并发扫描多个端口。
- 输出开放端口列表及其服务类型。

=== 高级端口扫描器 🚪🔑 ===
请选择模式：1. 单主机扫描  2. 批量扫描（从文件）: 2
请输入包含目标的文件路径（JSON 格式）： scan_list.txt

开始扫描主机 baidu.com 的端口 80-443...

扫描 baidu.com:   0%|▏                                                   | 1/364 [00:01<11:20,  1.87s/it][实时发现] 主机 baidu.com 端口 80 开放: 服务 http | Banner: Unknown
扫描 baidu.com:  83%|█████████████████████████████████████████▎        | 301/364 [00:07<00:01, 43.56it/s][实时发现] 主机 baidu.com 端口 443 开放: 服务 https | Banner: Unknown
扫描 baidu.com: 100%|██████████████████████████████████████████████████| 364/364 [00:08<00:00, 45.29it/s] 

开始扫描主机 hackerchi.top 的端口 1-1000...

扫描 hackerchi.top:   0%|                                                       | 0/1000 [00:00<?, ?it/s][实时发现] 主机 hackerchi.top 端口 80 开放: 服务 http | Banner: Unknown
扫描 hackerchi.top:  42%|██████████████████▉                          | 421/1000 [00:09<00:15, 37.99it/s][实时发现] 主机 hackerchi.top 端口 443 开放: 服务 https | Banner: Unknown
扫描 hackerchi.top: 100%|████████████████████████████████████████████| 1000/1000 [00:20<00:00, 49.40it/s]
扫描结果已保存到 batch_scan_results.json

#文件保存数据
[
    {
        "host": "baidu.com",
        "open_ports": [
            [
                80,
                "http",
                "Unknown"
            ],
            [
                443,
                "https",
                "Unknown"
            ]
        ]
    },
    {
        "host": "hackerchi.top",
        "open_ports": [
            [
                80,
                "http",
                "Unknown"
            ],
            [
                443,
                "https",
                "Unknown"
            ]
        ]
    }
]

### **2. Web 服务探测工具 🌐🧭**

**作用**：发送 HTTP 请求，检测目标网站的响应状态码和服务指纹。

**关键库**：`requests`

**实现思路**：

- 使用 `requests` 模块发送 `HEAD` 请求，获取响应头信息。
- 分析服务器响应（如 `Server` 字段）来判断服务类型。

#实例网址文件
https://www.baidu.com

#测试返回数据
[
    {
        "URL": "https://www.baidu.com",
        "Status Code": 200,
        "Status Explanation": "OK - ����ɹ����������������������Դ��",
        "Server": "BWS/1.1",
        "Server Explanation": "Unknown - �޷�ȷ���ķ��������͡�",
        "Content Analysis": "Login Page - ҳ�������¼������",
        "SSL Info": {
            "Issuer": {
                "countryName": "BE",
                "organizationName": "GlobalSign nv-sa",
                "commonName": "GlobalSign RSA OV SSL CA 2018"
            },
            "Subject": {
                "countryName": "CN",
                "stateOrProvinceName": "beijing",
                "localityName": "beijing",
                "organizationName": "Beijing Baidu Netcom Science Technology Co., Ltd",
                "commonName": "baidu.com"
            },
            "Valid From": "Jul  8 01:41:02 2024 GMT",
            "Valid Until": "Aug  9 01:41:01 2025 GMT",
            "Serial Number": "4E4003A65EB681F87F4BD8EB",
            "Version": 3
        }
    }
```

---

### **3. 子域名枚举工具 🌍📡**

**作用**：发现目标域名的子域名，辅助后续攻击。

**关键库**：`socket`, `itertools`

**实现思路**：

- 使用常见的子域字典生成可能的子域组合。
- 通过 DNS 查询验证子域是否存在（如解析成功）。


### **4. 文件与目录枚举工具 📂🗂️**

**作用**：扫描目标服务器的隐藏文件或目录。

**关键库**：`requests`

**实现思路**：

- 使用路径字典（如 `/admin`, `/backup.zip`）枚举可能路径。
- 检查 HTTP 响应是否为 200 或 403，判断资源是否存在。

### **5. SQL 注入检测工具 💉🗄️**

**作用**：检测目标网站是否存在 SQL 注入漏洞。

**关键库**：`requests`, `re`

**实现思路**：

- 构造常见的 SQL 注入 Payload（如 `' OR 1=1 --`）。
- 检测返回页面是否包含数据库错误信息或异常。

### **6. XSS 漏洞检测工具 💣📜**

**作用**：检测目标网站是否存在跨站脚本攻击（XSS）漏洞。

**关键库**：`requests`, `BeautifulSoup`

**实现思路**：

- 注入常见的恶意 JavaScript 脚本（如 `<script>alert(1)</script>`）。
- 检查页面是否回显或执行恶意脚本。

---

### **7. HTTP 参数污染检测工具 🧪🔗**

**作用**：测试目标网站对重复参数的处理是否正确。

**关键库**：`requests`

**实现思路**：

- 构造重复的 URL 参数（如 `?id=1&id=2`）。
- 分析响应结果，判断是否存在异常行为。

---

### **8. HTTP Header 安全检测工具 🛡️📄**

**作用**：分析 HTTP 响应头的安全配置，检测是否缺失关键头信息。

**关键库**：`requests`

**实现思路**：

- 提取常见安全头（如 `X-Frame-Options`, `Content-Security-Policy`）。
- 提示未配置或配置错误的安全头。

---

### **9. 网站指纹识别工具 🔍🛠️**

**作用**：爬取目标网站内容，根据特征识别目标的技术栈或 CMS 系统。

**关键库**：`requests`, `BeautifulSoup`

**实现思路**：

- 提取网站的 HTML 标记、JS 文件、CSS 文件等信息。
- 匹配已知特征库，推测网站技术栈。

---

### **10. 文件上传漏洞检测工具 📤🛠️**

**作用**：测试目标网站是否允许上传危险文件（如 PHP 脚本）。

**关键库**：`requests`

**实现思路**：

- 上传伪装的文件（如 `test.php`）。
- 检测是否可以通过 URL 直接访问文件。

---

### **11. 开放端口服务探测工具 🔎⚡**

**作用**：扫描目标开放端口，获取服务 Banner 信息。

**关键库**：`socket`, `subprocess`

**实现思路**：

- 使用 `socket` 连接端口，获取 Banner 数据（如 FTP、SMTP 服务信息）。
- 输出识别到的服务类型和版本。

---

### **12. HTTP 响应时间分析工具 ⏱️📡**

**作用**：分析目标网站的响应时间，检测性能瓶颈或防火墙干扰。

**关键库**：`requests`, `time`

**实现思路**：

- 使用 `time` 模块记录请求响应时间。
- 支持多次测试，输出平均响应时间。

---

### **13. HTTP 参数爆破工具 🚀🔗**

**作用**：检测隐藏的 HTTP 参数（如 `debug`, `test`）。

**关键库**：`requests`, `itertools`

**实现思路**：

- 使用参数字典逐个尝试传递参数。
- 检测返回结果是否发生变化。

---

### **14. WAF 探测工具 🛡️⚡**

**作用**：检测目标网站是否部署了 Web 应用防火墙（WAF）。

**关键库**：`requests`

**实现思路**：

- 发送恶意请求（如 SQL 注入 Payload）。
- 检测响应是否包含 WAF 特征（如阻断页面）。

---

### **15. TLS/SSL 配置检测工具 🔐🌍**

**作用**：分析目标网站的 TLS/SSL 配置，检测是否存在弱点。

**关键库**：`ssl`, `socket`

**实现思路**：

- 获取目标服务器的证书信息（如过期时间、加密算法）。
- 检查是否启用了弱加密协议（如 SSLv2）。

---

---

## **二、密码破解工具 🔓🔑**

### **16. 哈希破解工具 🧮🔓**

**作用**：通过字典或暴力破解常见哈希（如 MD5、SHA-1）。

**关键库**：`hashlib`, `itertools`

**实现思路**：

- 使用字典生成可能的明文组合。
- 将每个明文加密后与目标哈希值对比。

---

### **17. ZIP 文件密码破解工具 📦🔓**

**作用**：破解加密的 ZIP 文件密码。

**关键库**：`zipfile`, `itertools`

**实现思路**：

- 使用密码字典或暴力生成密码组合。
- 尝试解压文件，验证密码是否正确。

---

### **18. Wi-Fi 握手包密码破解工具 📶🔓**

**作用**：解析 Wi-Fi 握手包中的加密数据，尝试破解密码。

**关键库**：`scapy`, `hashlib`

**实现思路**：

- 使用 `scapy` 提取握手包中的加密信息。
- 结合密码字典进行暴力破解。

---

### **19. PDF 文件密码破解工具 📄🔓**

**作用**：破解加密 PDF 文件的访问密码。

**关键库**：`PyPDF2`, `itertools`

**实现思路**：

- 使用 `PyPDF2` 加载 PDF 文件，逐一尝试密码。
- 输出成功破解的密码。

---

### **20. JWT 密钥破解工具 🧩🔑**

**作用**：暴力破解 JSON Web Token 的签名密钥（HMAC）。

**关键库**：`jwt`, `hashlib`

**实现思路**：

- 使用字典生成可能的密钥。
- 验证生成的 Token 是否与目标 Token 匹配。

---

### **21. 基于社工规则的密码生成工具 🧑‍💻🔐**

**作用**：根据目标的社交信息生成可能的密码列表。

**关键库**：`itertools`

**实现思路**：

- 输入目标的相关信息（如姓名、生日、爱好）。
- 根据常见密码组合规则生成密码。

---

---

## **三、渗透测试工具 🛠️💻**

### **22. 反向 Shell 工具 🖥️🔗**

**作用**：建立反向连接，用于远程控制目标主机。

**关键库**：`socket`, `subprocess`

**实现思路**：

- 客户端向攻击者的服务器发起连接。
- 使用 `subprocess` 执行系统命令并返回结果。

---

### **23. ARP 欺骗工具 🛡️📡**

**作用**：伪装为网关，拦截局域网通信。

**关键库**：`scapy`

**实现思路**：

- 构造虚假的 ARP 响应包并发送到局域网设备。
- 将目标设备的流量中转到攻击者设备。

---

---

## **三、渗透测试工具 🛠️💻**

### **24. 缓冲区溢出测试工具 💥🧵**

**作用**：测试目标服务是否存在缓冲区溢出漏洞。

**关键库**：`socket`

**实现思路**：

- 构造超长的字符串填充缓冲区。
- 发送到目标服务，观测是否导致崩溃或异常行为。
- 可进一步扩展为测试返回地址覆盖。

---

### **25. 文件上传渗透工具 📤🐍**

**作用**：测试文件上传功能是否可执行恶意代码。

**关键库**：`requests`

**实现思路**：

- 上传伪装的恶意文件（如 `.php` 或 `.jsp` 文件）。
- 检查是否可通过 URL 访问并执行恶意脚本。

---

### **26. HTTP 请求重放工具 🔁📡**

**作用**：重放捕获的 HTTP 请求，测试重复请求的效果（如 CSRF）。

**关键库**：`requests`

**实现思路**：

- 从文本文件或抓包工具导入 HTTP 请求格式。
- 使用 `requests` 模拟发送，并分析响应结果。

---

### **27. HTTP 响应伪造工具 🛠️🔗**

**作用**：伪造 HTTP 响应包，用于测试客户端的安全性。

**关键库**：`socket`, `http.server`

**实现思路**：

- 模拟 HTTP 服务器，构造自定义响应内容（如恶意代码）。
- 返回伪造的响应给客户端，用于测试客户端解析行为。

---

### **28. 数据包重构工具 📦🔗**

**作用**：将捕获的网络数据包重新组装为完整会话。

**关键库**：`scapy`

**实现思路**：

- 从 PCAP 文件中提取 TCP/UDP 流数据包。
- 按顺序重组为完整的网络会话数据。

---

### **29. 本地代理工具 🛠️🔀**

**作用**：创建本地代理服务器，用于中间人攻击和数据分析。

**关键库**：`socket`, `ssl`

**实现思路**：

- 建立监听套接字，转发客户端请求到目标服务器。
- 可扩展为解密 HTTPS 流量，并修改请求或响应。

---

### **30. 网络嗅探与实时分析工具 📡📊**

**作用**：捕获局域网流量并实时分析协议数据（如 HTTP、DNS）。

**关键库**：`scapy`, `pyshark`

**实现思路**：

- 使用 `scapy` 嗅探特定协议的数据包。
- 实时解析并提取关键信息（如 URL、域名）。

---

### **31. 数据包注入工具 📦💣**

**作用**：向网络中注入伪造的数据包，用于测试目标的异常处理。

**关键库**：`scapy`

**实现思路**：

- 构造自定义的 TCP/UDP 数据包（如伪造源地址）。
- 将伪造数据包发送至目标网络。

---

### **32. DNS 隧道检测工具 🌐🔍**

**作用**：检测目标是否利用 DNS 隧道进行数据传输。

**关键库**：`scapy`, `re`

**实现思路**：

- 捕获 DNS 请求包并解析域名。
- 检测域名中是否包含可疑的加密或异常数据。

---

### **33. 网络流量趋势分析工具 📊📈**

**作用**：分析网络流量日志，识别异常流量趋势。

**关键库**：`pandas`, `matplotlib`

**实现思路**：

- 从网络日志中提取时间戳和数据量信息。
- 绘制流量趋势图，标注异常流量高峰。

---

### **34. 端口爆破工具 🎯🔑**

**作用**：针对开放端口尝试暴力破解服务登录（如 Redis、MySQL）。

**关键库**：`socket`, `itertools`

**实现思路**：

- 构造常见协议（如 Redis AUTH）的认证请求。
- 遍历密码字典，测试服务是否接受连接。

---

### **35. HTTP 参数模糊测试工具 🧪🔍**

**作用**：向目标网站发送随机或恶意参数，测试其异常处理能力。

**关键库**：`requests`, `itertools`

**实现思路**：

- 生成随机参数值（如超长字符串、特殊字符）。
- 观察目标网站是否返回异常响应或崩溃。

---

---

## **四、数据包嗅探工具 📡**

### **36. 数据包嗅探工具 🕵️‍♂️📡**

**作用**：实时捕获网络流量并解析协议数据。

**关键库**：`scapy`

**实现思路**：

- 使用 `scapy` 监听网络接口上的所有数据包。
- 按协议类型（如 TCP、UDP、HTTP）分类解析。

---

### **37. HTTP 数据包分析工具 🌐🔍**

**作用**：提取 HTTP 请求和响应中的关键信息。

**关键库**：`scapy`, `BeautifulSoup`

**实现思路**：

- 捕获 HTTP 数据包，提取 URL 和 Header 信息。
- 支持解析 HTML 响应内容。

---

### **38. DNS 请求记录分析工具 🌍🔗**

**作用**：统计 DNS 请求中的域名及其频率。

**关键库**：`scapy`, `collections`

**实现思路**：

- 捕获 DNS 查询包，提取域名信息。
- 统计域名出现频率，识别异常请求。

---

### **39. HTTPS 数据包解密工具 🔐📦**

**作用**：解密 HTTPS 流量（配合自签名证书）。

**关键库**：`ssl`, `pyOpenSSL`

**实现思路**：

- 配置中间人代理，截获 HTTPS 流量。
- 使用自签名证书解密流量并解析数据内容。

---

### **40. 网络会话重组工具 🔄📡**

**作用**：将捕获的网络数据包按连接会话重组，便于分析完整通信。

**关键库**：`scapy`, `itertools`

**实现思路**：

- 按源地址、目标地址和端口对数据包分组。
- 按序号重组数据包，恢复完整会话。

---

---

## **五、取证分析工具 🕵️‍♀️⚖️**

### **41. 日志分析工具 📜🔍**

**作用**：分析服务器日志，发现异常访问或攻击痕迹。

**关键库**：`re`, `pandas`

**实现思路**：

- 使用正则表达式解析日志文件中的 IP 和路径。
- 检测高频访问 IP 或异常的 HTTP 方法。

---

### **42. 内存转储分析工具 🧠🔗**

**作用**：从内存转储中提取密码、会话令牌等敏感信息。

**关键库**：`re`, `os`

**实现思路**：

- 读取内存转储文件，搜索常见的敏感数据模式（如密码格式）。
- 提取并分类保存。

---

### **43. 文件恢复工具 🗂️♻️**

**作用**：从磁盘或文件系统转储中恢复已删除文件。

**关键库**：`os`, `struct`

**实现思路**：

- 分析文件系统结构，定位删除文件的残留数据块。
- 重建文件并保存到本地。

---

### **44. 恶意软件静态分析工具 🦠🛠️**

**作用**：提取恶意软件文件中的静态特征信息。

**关键库**：`pefile`, `hashlib`

**实现思路**：

- 提取 PE 文件的导入表、节表和字符串信息。
- 计算哈希值，匹配已知恶意文件特征库。

---

### **45. 网络日志分析工具 📊🕵️**

**作用**：分析网络流量日志，发现潜在攻击行为（如 DoS 攻击）。

**关键库**：`pandas`

**实现思路**：

- 按时间段统计请求频率。
- 识别异常高频访问 IP 或重复请求。

---

### **46. 磁盘镜像解析工具 💽🔎**

**作用**：解析磁盘镜像文件，提取文件和分区信息。

**关键库**：`pytsk3`

**实现思路**：

- 加载磁盘镜像，提取分区表结构。
- 遍历文件系统，提取文件内容。

---

### **47. 恶意代码检测工具 🦠📄**

**作用**：检测文件中的恶意代码片段或特征字符串。

**关键库**：`re`, `hashlib`

**实现思路**：

- 使用正则表达式匹配恶意代码模式。
- 提取并标记潜在的危险代码片段。

---

### **48. 系统快照比较工具 🖥️🔍**

**作用**：比较系统快照，检测文件或注册表的异常变化。

**关键库**：`os`, `filecmp`

**实现思路**：

- 对比两个快照中的文件系统结构和文件内容。
- 输出新增、删除或修改的文件列表。

---

### **49. 进程行为分析工具 🧩🔍**

**作用**：分析系统中可疑进程的行为（如网络连接、文件操作）。

**关键库**：`psutil`, `os`

**实现思路**：

- 使用 `psutil` 获取进程的资源使用和网络连接状态。
- 记录可疑进程的行为日志。

---

### **50. 网络取证报告生成工具 📋⚖️**

**作用**：自动化生成网络取证分析报告。

**关键库**：`pandas`, `jinja2`

**实现思路**：

- 从流量日志、内存转储等数据源提取关键信息。
- 使用模板生成 HTML 或 PDF 格式的分析报告。
